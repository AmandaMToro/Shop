<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/bootstrap.min.css" />

</head>
<body>

  
  <nav class="navbar navbar-expand-lg navbar-light bg-light ">
    <div class="container-fluid">
        <img src="https://cdn.shopify.com/s/files/1/0273/7884/3785/t/56/assets/logo.svg?v=13855232805501150294" alt="" width="600" height="200"  class="d-inline-block align-text-center ">
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="#">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Rebajas</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Categorias
            </a>
        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
            <li><a class="dropdown-item" href="#">Ropa</a></li>
            <li><a class="dropdown-item" href="#">Zapatos</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#">Complementos</a></li>
        </ul>
        </li>
        <li class="nav-item">
          <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true"></a>
        </li>
        </ul>
        <form class="d-flex">
          <input class="form-control me-2" type="search" placeholder="Buscar articulo" aria-label="Search">
          <button class="btn btn-outline-success display-1" type="submit">Buscar</button>
        </form>
      </div>
    </div>
  </nav>
 
<div id="carouselExampleControls" class="carousel slide w-80 h-100 d-flex justify-content-center align-content-center" data-bs-ride="carousel">
  <div class="carousel-inner d-flex justify-content-start align-content-lg-start " >
    <div class="carousel-item active">

      <img src="carrusel1.jpg" class="d-block w-40" alt="...">
    </div>
    <div class="carousel-item">
      <img src="carrusel2.jpg" class="d-block w-40" alt="...">
    </div>
    <div class="carousel-item">
      <img src="carrusel3.jpg" class="d-block w-40" alt="...">
    </div>
    <div class="carousel-item">
      <img src="carrusel4.jpg" class="d-block w-40" alt="...">
    </div>
    <div class="carousel-item">
      <img src="carrusel5.jpg" class="d-block w-40" alt="...">
    </div>
    <div class="carousel-item">
      <img src="carrusel6.jpg" class="d-block w-40" alt="...">
    </div>

  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>
<div>
  
</div>


<!-- 
<div class="card-group">
  <div class="card">
    <img src="carrusel1.jpg" class="card-img-top w-50 h-60" alt="...">
  <div class="card-body">
      <h5 class="card-title">Vestido Carlo Flores - Blanco </h5>
      <p class="card-text w-50 h-60 d-flex justify-content-center">25,99 €</p>
  </div>
   
  </div>
  <div class="card">
    <img src="carrusel2.jpg" class="card-img-top w-50 h-60" alt="...">
    <div class="card-body">
      <h5 class="card-title"> Vestido turquesa Amanda</h5>
      <p class="card-text w-50 h-60 d-flex justify-content-center">30.95€ </p>

    </div>
  
  </div>
  <div class="card">
    <img src="carrusel3.jpg" class="card-img-top w-50 h-60" alt="...">
    <div class="card-body">
      <h5 class="card-title"> Vestido fresa-Natalia </h5>
      <p class="card-text w-50 h-60 d-flex justify-content-center"> 22,99 €</p>
    </div>
   
  </div>


<div class="card-group">
  <div class="card d-flex justify-content-center">
    <img src="carrusel4.jpg" class="card-img-top w-50 h-60 d-flex justify-content-center" alt="...">
    <div class="card-body">
      <h5 class="card-title  ">Vestido largo-Ibizenco</h5>
      <p class="card-text w-50 h-60 d-flex justify-content-center">29.95€</p>
    </div>
    
  </div>
  <div class="card">
    <img src="carrusel5.jpg" class="card-img-top w-50 h-60" alt="...">
    <div class="card-body">
      <h5 class="card-title">Vestido Rojo-Manzana</h5>
      <p class="card-text w-50 h-60 d-flex justify-content-center">25.95</p>
    </div>
   
  </div>
  <div class="card">
    <img src="carrusel6.jpg" class="card-img-top w-50 h-60" alt="...">
    <div class="card-body">
      <h5 class="card-title">Vestido Betina - Aro</h5>
      <p class="card-text w-50 h-60 d-flex justify-content-center">This is a wider card with supporting text below as a natural lead-in to additional content. This card has even longer content than the first to show that equal height action.</p>
    </div>
   
  </div>
</div> -->

<script>
  window.onload = function () {
    // Variables
    const baseDeDatos = [
        {
            id: 1,
            nombre: 'Vestido Carlo Flores - Blanco',
            precio: 20.95,
            imagen: "carrusel1.jpg"
        },
        {
            id: 2,
            nombre: 'Vestido turquesa Amanda',
            precio: 30.95,
            imagen: 'carrusel2.jpg'
        },
        {
            id: 3,
            nombre: 'Vestido Fresa- Natalia',
            precio: 25.95,
            imagen: 'carrusel3.jpg'
        },
        {
            id: 4,
            nombre: 'Vestido largo-Ibizenco',
            precio: 35.95,
            imagen: 'carrusel4.jpg'
        },
        {
            id: 5,
            nombre: 'Vestido Rojo Manzana',
            precio: 20.95,
            imagen: 'carrusel5.jpg'
        },
        {
            id: 6,
            nombre: 'Vestido Betina-Aroa',
            precio: 15.95,
            imagen: 'carrusel6.jpg'
        },

    ];

    let carrito = [];
    let total = 0;
    const DOMitems = document.querySelector('#items');
    const DOMcarrito = document.querySelector('#carrito');
    const DOMtotal = document.querySelector('#total');
    const DOMbotonVaciar = document.querySelector('#boton-vaciar');

    // Funciones

    /**
    * Dibuja todos los productos a partir de la base de datos. No confundir con el carrito
    */
    function renderizarProductos() {
        baseDeDatos.forEach((info) => {
            // Estructura
            const miNodo = document.createElement('div');
            miNodo.classList.add('card', 'col-sm-4');
            // Body
            const miNodoCardBody = document.createElement('div');
            miNodoCardBody.classList.add('card-body');
            // Titulo
            const miNodoTitle = document.createElement('h5');
            miNodoTitle.classList.add('card-title');
            miNodoTitle.textContent = info.nombre;
            // Imagen
            const miNodoImagen = document.createElement('img');
            miNodoImagen.classList.add('img-fluid');
            miNodoImagen.setAttribute('src', info.imagen);
            // Precio
            const miNodoPrecio = document.createElement('p');
            miNodoPrecio.classList.add('card-text');
            miNodoPrecio.textContent = info.precio + '€';
            // Boton 
            const miNodoBoton = document.createElement('button');
            miNodoBoton.classList.add('btn', 'btn-primary');
            miNodoBoton.textContent = '+';
            miNodoBoton.setAttribute('marcador', info.id);
            miNodoBoton.addEventListener('click', anyadirProductoAlCarrito);
            // Insertamos
            miNodoCardBody.appendChild(miNodoImagen);
            miNodoCardBody.appendChild(miNodoTitle);
            miNodoCardBody.appendChild(miNodoPrecio);
            miNodoCardBody.appendChild(miNodoBoton);
            miNodo.appendChild(miNodoCardBody);
            DOMitems.appendChild(miNodo);
        });
    }

    /**
    * Evento para añadir un producto al carrito de la compra
    */
    function anyadirProductoAlCarrito(evento) {
        // Anyadimos el Nodo a nuestro carrito
        carrito.push(evento.target.getAttribute('marcador'))
        // Calculo el total
        calcularTotal();
        // Actualizamos el carrito 
        renderizarCarrito();

    }

    /**
    * Dibuja todos los productos guardados en el carrito
    */
    function renderizarCarrito() {
        // Vaciamos todo el html
        DOMcarrito.textContent = '';
        // Quitamos los duplicados
        const carritoSinDuplicados = [...new Set(carrito)];
        // Generamos los Nodos a partir de carrito
        carritoSinDuplicados.forEach((item) => {
            // Obtenemos el item que necesitamos de la variable base de datos
            const miItem = baseDeDatos.filter((itemBaseDatos) => {
                // ¿Coincide las id? Solo puede existir un caso
                return itemBaseDatos.id === parseInt(item);
            });
            // Cuenta el número de veces que se repite el producto
            const numeroUnidadesItem = carrito.reduce((total, itemId) => {
                // ¿Coincide las id? Incremento el contador, en caso contrario no mantengo
                return itemId === item ? total += 1 : total;
            }, 0);
            // Creamos el nodo del item del carrito
            const miNodo = document.createElement('li');
            miNodo.classList.add('list-group-item', 'text-right', 'mx-2');
            miNodo.textContent = `${numeroUnidadesItem} x ${miItem[0].nombre} - ${miItem[0].precio}€`;
            // Boton de borrar
            const miBoton = document.createElement('button');
            miBoton.classList.add('btn', 'btn-danger', 'mx-5');
            miBoton.textContent = 'X';
            miBoton.style.marginLeft = '1rem';
            miBoton.dataset.item = item;
            miBoton.addEventListener('click', borrarItemCarrito);
            // Mezclamos nodos
            miNodo.appendChild(miBoton);
            DOMcarrito.appendChild(miNodo);
        });
    }

    /**
    * Evento para borrar un elemento del carrito
    */
    function borrarItemCarrito(evento) {
        // Obtenemos el producto ID que hay en el boton pulsado
        const id = evento.target.dataset.item;
        // Borramos todos los productos
        carrito = carrito.filter((carritoId) => {
            return carritoId !== id;
        });
        // volvemos a renderizar
        renderizarCarrito();
        // Calculamos de nuevo el precio
        calcularTotal();
    }

    /**
    * Calcula el precio total teniendo en cuenta los productos repetidos
    */
    function calcularTotal() {
        // Limpiamos precio anterior
        total = 0;
        // Recorremos el array del carrito
        carrito.forEach((item) => {
            // De cada elemento obtenemos su precio
            const miItem = baseDeDatos.filter((itemBaseDatos) => {
                return itemBaseDatos.id === parseInt(item);
            });
            total = total + miItem[0].precio;
        });
        // Renderizamos el precio en el HTML
        DOMtotal.textContent = total.toFixed(2);
    }

    /**
    * Varia el carrito y vuelve a dibujarlo
    */
    function vaciarCarrito() {
        // Limpiamos los productos guardados
        carrito = [];
        // Renderizamos los cambios
        renderizarCarrito();
        calcularTotal();
    }

    // Eventos
    DOMbotonVaciar.addEventListener('click', vaciarCarrito);

    // Inicio
    renderizarProductos();


  } 
</script>
</head>
<body>
<div class="container">
  <div class="row">
      <!-- Elementos generados a partir del JSON -->
      <main id="items" class="col-sm-8 row"></main>
      <!-- Carrito -->
      <aside class="col-sm-4">
          <h2>Carrito de la compra</h2>
          <!-- Elementos del carrito -->
          <ul id="carrito" class="list-group"></ul>
          <hr>
          <!-- Precio total -->
          <p class="text-right">Total: <span id="total"></span>&euro;</p>
          <button id="boton-vaciar" class="btn btn-danger">Vaciar</button>
          <!-- <button type="button" class="btn btn-success">Comprar</button> -->
          <input type="button" class="btn btn-success" onclick="alert('Gracias por su compra')" value="Comprar" />
          
        
      </aside>
  </div>
</div>

<script src="js/jquery-3.5.1.slim.min.js"></script>
<script src="js/popper.min.js"></script>
<script src="js/bootstrap.min.js"></script>


<footer>
 
  <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="44" height="44" viewBox="0 0 24 24" stroke-width="3" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
    <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
  </svg>
<p>Shop Amanda ~Valentina~ </p>
</footer>
</body>
</html>
